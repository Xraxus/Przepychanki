{% extends "base.htm" %}

{% block body %}
    <h1>Faza 0</h1>
    <p>Ustawianie pionków w kolejkach</p>

    <h1>Gracz {{ player.color }}: {{ player.name }}</h1>
    <p>Pozostałe pionki: {{ player.pawns|length }}</p>
    <p>Karty przepychanek : {{ player.jostling_hand }}</p>
    <form method="post">
        {% for shop_key, shop_value in game.board.shops.items() %}
        <table border=1>
            <tr>
                <th>{{ shop_value.name }}{% if shop_value.is_open == False %}<span style="color: red"> (remanent)</span>{% endif %}</th>
            </tr>
            <tr>
                <th>Towary</th>
                {% for good in shop_value.available_goods %}
                <td><strong>{{ good.name}}</strong>, {{ good.description }}</td>
                {% endfor %}
            </tr>
            <tr>
                <th>Kolejka</th>
                <td colspan="100%">{{ shop_value.queue }}</td>
            </tr>
            <tr>
                <td colspan="100%"><button type="submit" id="{{ shop_value.name }}" name="shop_name" value="{{ shop_value.name }}">Ustaw się</button></td>
            </tr>
        </table><br>
        {% endfor %}

        <table border="1">
        <tr>
            <th colspan="100%">Bazar</th>
        </tr>
        {% for shop_name,shop_items in game.board.bazaar.available_goods.items() %}
            <tr>
                <th>{{ shop_name }}</th>
                {% for good in shop_items %}
                    <td><strong>{{ good.name}}</strong>, {{ good.description }}</td>
                {% endfor %}
            </tr>
        {% endfor %}
        <tr>
            <th>Kolejka</th>
            <td colspan="100%">{{ game.board.bazaar.queue }}</td>
        </tr>
        <tr>
            <td colspan="100%"><button type="submit" id="Bazaar" name="shop_name" value="Bazaar">Ustaw się</button></td>
        </tr>
        </table>
    </form>
    {% for player in game.players %}
        <br><table border="1">
            <tr>
                <th colspan="100%">Lista zakupów gracza {{ player.name }}</th>
            </tr>
            <tr>
                <td colspan="100%"><strong>{{ player.shopping_list.shopping_list_number }} - {{ player.shopping_list.shopping_list_name }}</strong></td>
            </tr>
            {% for category, amount in player.shopping_list.needed_items.items()|sort(attribute='1', reverse=True) %}
                {% if amount != 0 %}
                <tr>
                    <td><strong>{{ category }}</strong></td>
                    <td>{{ amount }}</td>
                </tr>
                {% endif %}
            {% endfor %}
        </table>
    {% endfor %}
{% endblock %}